import{c as m,j as e,r as c}from"./client-C7wl62iw.js";async function x(){const a=await chrome.storage.sync.get(["autoClassify","enableNotifications","enableRecommendations","checkInvalidBookmarks","checkFrequency","autoCleanDuplicates","defaultCategory","serverUrl","aiProvider","aiApiKey","aiModel","aiApiUrl","recommendationMode","userClassificationRules"]);return{autoClassify:a.autoClassify!==!1,enableNotifications:a.enableNotifications!==!1,enableRecommendations:a.enableRecommendations!==!1,checkInvalidBookmarks:a.checkInvalidBookmarks!==!1,checkFrequency:a.checkFrequency??"60",autoCleanDuplicates:!!a.autoCleanDuplicates,defaultCategory:a.defaultCategory??"其他",serverUrl:a.serverUrl??"http://localhost:5175",aiProvider:a.aiProvider??"deepseek",aiApiKey:a.aiApiKey??"",aiModel:a.aiModel??"deepseek-chat",aiApiUrl:a.aiApiUrl??"https://api.deepseek.com",recommendationMode:a.recommendationMode??"local",userClassificationRules:a.userClassificationRules??[]}}async function d(a){await chrome.storage.sync.set(a)}function j(){const[a,i]=c.useState({autoClassify:!0,enableNotifications:!0,enableRecommendations:!0,checkInvalidBookmarks:!0,checkFrequency:"60",autoCleanDuplicates:!1,defaultCategory:"其他",serverUrl:"http://localhost:5175",aiProvider:"deepseek",aiApiKey:"",aiModel:"deepseek-chat",aiApiUrl:"https://api.deepseek.com",recommendationMode:"auto",userClassificationRules:[]}),[n,r]=c.useState(""),[l,o]=c.useState("");c.useEffect(()=>{(async()=>{const s=await x();i(s)})()},[]);async function u(){await d(a),alert("设置保存成功")}async function h(){const s={autoClassify:!0,enableNotifications:!0,enableRecommendations:!0,checkInvalidBookmarks:!0,checkFrequency:"60",autoCleanDuplicates:!1,defaultCategory:"其他",serverUrl:"http://localhost:5175",aiProvider:"deepseek",aiApiKey:"",aiModel:"deepseek-chat",aiApiUrl:"https://api.deepseek.com",recommendationMode:"local",userClassificationRules:[]};i(s),await d(s),alert("设置已重置为默认值")}function p(){if(!n||!l){alert("请填写完整的规则信息");return}try{new RegExp(n,"i")}catch{alert("正则表达式格式错误");return}const s=[...a.userClassificationRules??[],{pattern:n,category:l,created:Date.now()}];i({...a,userClassificationRules:s}),r(""),o("")}function v(s){const t=[...a.userClassificationRules??[]];t.splice(s,1),i({...a,userClassificationRules:t})}return e.jsxs("div",{children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"基本设置"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"自动分类书签"}),e.jsx("input",{type:"checkbox",checked:a.autoClassify,onChange:s=>i({...a,autoClassify:s.target.checked})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"启用通知"}),e.jsx("input",{type:"checkbox",checked:a.enableNotifications,onChange:s=>i({...a,enableNotifications:s.target.checked})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"智能推荐"}),e.jsx("input",{type:"checkbox",checked:a.enableRecommendations,onChange:s=>i({...a,enableRecommendations:s.target.checked})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"清理设置"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"检查失效书签"}),e.jsx("input",{type:"checkbox",checked:a.checkInvalidBookmarks,onChange:s=>i({...a,checkInvalidBookmarks:s.target.checked})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"检查频率（分钟）"}),e.jsx("input",{className:"input",value:a.checkFrequency,onChange:s=>i({...a,checkFrequency:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"自动清理重复书签"}),e.jsx("input",{type:"checkbox",checked:a.autoCleanDuplicates,onChange:s=>i({...a,autoCleanDuplicates:s.target.checked})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"分类设置"}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"默认分类"}),e.jsx("input",{className:"input",value:a.defaultCategory,onChange:s=>i({...a,defaultCategory:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"服务器地址"}),e.jsx("input",{className:"input",value:a.serverUrl||"",onChange:s=>i({...a,serverUrl:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"AI 提供商"}),e.jsxs("select",{className:"input",value:a.aiProvider||"deepseek",onChange:s=>i({...a,aiProvider:s.target.value}),children:[e.jsx("option",{value:"deepseek",children:"DeepSeek"}),e.jsx("option",{value:"openai",children:"OpenAI"})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"AI API 地址"}),e.jsx("input",{className:"input",value:a.aiApiUrl||"",onChange:s=>i({...a,aiApiUrl:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"AI 模型"}),e.jsx("input",{className:"input",value:a.aiModel||"",onChange:s=>i({...a,aiModel:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:"AI API Key"}),e.jsx("input",{className:"input",type:"password",value:a.aiApiKey||"",onChange:s=>i({...a,aiApiKey:s.target.value})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:"自定义分类规则"}),e.jsxs("div",{className:"row",children:[e.jsx("input",{className:"input",placeholder:"正则模式",value:n,onChange:s=>r(s.target.value)}),e.jsx("input",{className:"input",placeholder:"分类名",value:l,onChange:s=>o(s.target.value)}),e.jsx("button",{className:"btn",onClick:p,children:"添加规则"})]}),(a.userClassificationRules??[]).length===0&&e.jsx("div",{children:"暂无自定义规则"}),(a.userClassificationRules??[]).map((s,t)=>e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"模式:"})," ",s.pattern,"；",e.jsx("strong",{children:"分类:"})," ",s.category]}),e.jsx("button",{className:"btn",onClick:()=>v(t),children:"删除"})]},t))]}),e.jsxs("div",{className:"btns",children:[e.jsx("button",{className:"btn primary",onClick:u,children:"保存设置"}),e.jsx("button",{className:"btn",onClick:h,children:"恢复默认"})]})]})}const k=m(document.getElementById("root"));k.render(e.jsx(j,{}));
