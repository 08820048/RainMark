import{j as e,c as j,r as m,t as x}from"./theme-11K_mN9q.js";async function _(){const a=await chrome.storage.sync.get(["autoClassify","enableNotifications","enableRecommendations","checkInvalidBookmarks","checkFrequency","autoCleanDuplicates","defaultCategory","serverUrl","aiProvider","aiApiKey","aiModel","aiApiUrl","recommendationMode","userClassificationRules"]);return{autoClassify:a.autoClassify!==!1,enableNotifications:a.enableNotifications!==!1,enableRecommendations:a.enableRecommendations!==!1,checkInvalidBookmarks:a.checkInvalidBookmarks!==!1,checkFrequency:a.checkFrequency??"60",autoCleanDuplicates:!!a.autoCleanDuplicates,defaultCategory:a.defaultCategory??"其他",serverUrl:a.serverUrl??"http://localhost:5175",aiProvider:a.aiProvider??"deepseek",aiApiKey:a.aiApiKey??"",aiModel:a.aiModel??"deepseek-chat",aiApiUrl:a.aiApiUrl??"https://api.deepseek.com",recommendationMode:a.recommendationMode??"local",userClassificationRules:a.userClassificationRules??[]}}async function f(a){await chrome.storage.sync.set(a)}function v({checked:a,onChange:i,disabled:n,size:o="md",ariaLabel:c}){const d=o==="sm"?36:44,u=o==="sm"?20:24,h=o==="sm"?2:3,p=u-h*2,g=n?"var(--rm-border)":a?"var(--rm-accent)":"var(--rm-switch-off-bg)";return e.jsx(e.Fragment,{children:e.jsx("button",{type:"button",role:"switch","aria-checked":a,"aria-label":c,disabled:n,onClick:()=>!n&&i(!a),onKeyDown:s=>{n||(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),i(!a))},style:{width:d,height:u,borderRadius:u/2,border:"1px solid var(--rm-border)",background:g,display:"inline-flex",alignItems:"center",padding:h,boxSizing:"border-box",cursor:n?"not-allowed":"pointer",transition:"background .18s ease"},children:e.jsx("span",{style:{width:p,height:p,borderRadius:"999px",background:"#fff",boxShadow:"0 2px 6px rgba(0,0,0,.12)",transform:`translateX(${a?d-p-h*2:0}px)`,transition:"transform .18s ease"}})})})}function t(a,i){var n,o;try{const c=(o=(n=chrome==null?void 0:chrome.i18n)==null?void 0:n.getMessage)==null?void 0:o.call(n,a,i??[]);if(c)return c}catch{}return a}function y(){var a,i;try{if(String(((i=(a=chrome==null?void 0:chrome.i18n)==null?void 0:a.getUILanguage)==null?void 0:i.call(a))||navigator.language||"").toLowerCase().startsWith("zh"))return"zh"}catch{}return"en"}function k(){const[a,i]=m.useState({autoClassify:!0,enableNotifications:!0,enableRecommendations:!0,checkInvalidBookmarks:!0,checkFrequency:"60",autoCleanDuplicates:!1,defaultCategory:"其他",serverUrl:"http://localhost:5175",aiProvider:"deepseek",aiApiKey:"",aiModel:"deepseek-chat",aiApiUrl:"https://api.deepseek.com",recommendationMode:"auto",userClassificationRules:[]}),[n,o]=m.useState(""),[c,d]=m.useState("");m.useEffect(()=>{(async()=>{const s=await _();i(s)})()},[]),m.useEffect(()=>{try{document.title=t("options_page_title");const s=y();document.documentElement.lang=s}catch{}},[]);async function u(){await f(a),x.success(t("alert_settings_saved"))}async function h(){const s={autoClassify:!0,enableNotifications:!0,enableRecommendations:!0,checkInvalidBookmarks:!0,checkFrequency:"60",autoCleanDuplicates:!1,defaultCategory:"其他",serverUrl:"http://localhost:5175",aiProvider:"deepseek",aiApiKey:"",aiModel:"deepseek-chat",aiApiUrl:"https://api.deepseek.com",recommendationMode:"local",userClassificationRules:[]};i(s),await f(s),x.success(t("alert_settings_reset"))}function p(){if(!n||!c){x.warning(t("alert_fill_rule"));return}try{new RegExp(n,"i")}catch{x.error(t("alert_regex_invalid"));return}const s=[...a.userClassificationRules??[],{pattern:n,category:c,created:Date.now()}];i({...a,userClassificationRules:s}),o(""),d("")}function g(s){const r=[...a.userClassificationRules??[]];r.splice(s,1),i({...a,userClassificationRules:r})}function l(s){const r=document.getElementById(s);r&&r.scrollIntoView({behavior:"smooth",block:"start"})}return e.jsxs("div",{children:[e.jsx("div",{className:"header",children:e.jsxs("div",{className:"brand",children:[e.jsx("img",{src:"../../icons/icon48.png",width:"24",height:"24",alt:"RainMark"}),e.jsxs("div",{children:["RainMark · ",t("options_header_title")]})]})}),e.jsxs("div",{className:"layout",children:[e.jsx("aside",{className:"sidebar",children:e.jsxs("nav",{className:"nav",children:[e.jsx("a",{href:"#basic",onClick:s=>{s.preventDefault(),l("basic")},children:t("options_nav_basic")}),e.jsx("a",{href:"#clean",onClick:s=>{s.preventDefault(),l("clean")},children:t("options_nav_clean")}),e.jsx("a",{href:"#category",onClick:s=>{s.preventDefault(),l("category")},children:t("options_nav_category")}),e.jsx("a",{href:"#rules",onClick:s=>{s.preventDefault(),l("rules")},children:t("options_nav_rules")}),e.jsx("a",{href:"#actions",onClick:s=>{s.preventDefault(),l("actions")},children:t("options_nav_actions")})]})}),e.jsxs("main",{className:"content",children:[e.jsx("section",{id:"basic",className:"section",children:e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:t("options_basic_title")}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_auto_classify")}),e.jsx(v,{checked:a.autoClassify,onChange:s=>i({...a,autoClassify:s}),ariaLabel:t("opt_auto_classify")})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_enable_notifications")}),e.jsx(v,{checked:a.enableNotifications,onChange:s=>i({...a,enableNotifications:s}),ariaLabel:t("opt_enable_notifications")})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_enable_recommendations")}),e.jsx(v,{checked:a.enableRecommendations,onChange:s=>i({...a,enableRecommendations:s}),ariaLabel:t("opt_enable_recommendations")})]})]})}),e.jsx("section",{id:"clean",className:"section",children:e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:t("options_clean_title")}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_check_invalid")}),e.jsx(v,{checked:a.checkInvalidBookmarks,onChange:s=>i({...a,checkInvalidBookmarks:s}),ariaLabel:t("opt_check_invalid")})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_check_frequency")}),e.jsx("input",{className:"input",value:a.checkFrequency,onChange:s=>i({...a,checkFrequency:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_auto_clean_duplicates")}),e.jsx(v,{checked:a.autoCleanDuplicates,onChange:s=>i({...a,autoCleanDuplicates:s}),ariaLabel:t("opt_auto_clean_duplicates")})]})]})}),e.jsx("section",{id:"category",className:"section",children:e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:t("options_category_title")}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_default_category")}),e.jsx("input",{className:"input",value:a.defaultCategory,onChange:s=>i({...a,defaultCategory:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_server_url")}),e.jsx("input",{className:"input",value:a.serverUrl||"",onChange:s=>i({...a,serverUrl:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_ai_provider")}),e.jsxs("select",{className:"input",value:a.aiProvider||"deepseek",onChange:s=>i({...a,aiProvider:s.target.value}),children:[e.jsx("option",{value:"deepseek",children:"DeepSeek"}),e.jsx("option",{value:"openai",children:"OpenAI"})]})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_ai_api_url")}),e.jsx("input",{className:"input",value:a.aiApiUrl||"",onChange:s=>i({...a,aiApiUrl:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_ai_model")}),e.jsx("input",{className:"input",value:a.aiModel||"",onChange:s=>i({...a,aiModel:s.target.value})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{children:t("opt_ai_api_key")}),e.jsx("input",{className:"input",type:"password",value:a.aiApiKey||"",onChange:s=>i({...a,aiApiKey:s.target.value})})]})]})}),e.jsx("section",{id:"rules",className:"section",children:e.jsxs("div",{className:"card",children:[e.jsx("h3",{children:t("options_rules_title")}),e.jsxs("div",{className:"row",children:[e.jsx("input",{className:"input",placeholder:t("placeholder_regex_pattern"),value:n,onChange:s=>o(s.target.value)}),e.jsx("input",{className:"input",placeholder:t("placeholder_category_name"),value:c,onChange:s=>d(s.target.value)}),e.jsx("button",{className:"btn",onClick:p,children:t("btn_add_rule")})]}),(a.userClassificationRules??[]).length===0&&e.jsx("div",{children:t("no_custom_rules")}),(a.userClassificationRules??[]).map((s,r)=>e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("strong",{children:t("label_pattern")})," ",s.pattern,"；",e.jsx("strong",{children:t("label_category")})," ",s.category]}),e.jsx("button",{className:"btn",onClick:()=>g(r),children:t("btn_delete")})]},r))]})}),e.jsx("section",{id:"actions",className:"section",children:e.jsxs("div",{className:"btns",children:[e.jsx("button",{className:"btn primary",onClick:u,children:t("btn_save_settings")}),e.jsx("button",{className:"btn",onClick:h,children:t("btn_restore_defaults")})]})})]})]})]})}const b=j(document.getElementById("root"));b.render(e.jsx(k,{}));
